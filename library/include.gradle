// used by `settings.gradle` under the Root Project

def AR_LOCAL_PATH = buildscript.sourceFile.parentFile

// define a simple log method
def ARLog0(msg) {
    println "[${rootProject.name}] <${buildscript.sourceFile.name}> ${String.valueOf(msg)}"
}

def ARTIFACT_ID_PRO_NAME = 'PROJECT_POM_ARTIFACT_ID'
def INCLUDED_LIB_FILE_NAME = '.includedby.androidrubick'

def gradlePropertiesFile = file('./gradle.properties')

if (gradlePropertiesFile.isFile()) {
    Properties properties = new Properties()
    properties.load(gradlePropertiesFile.newReader())

    def moduleName = properties.getProperty(ARTIFACT_ID_PRO_NAME)

    // 作为外部模块打包时，需要加上前缀
    ARLog0 "`${moduleName}` module loaded"
    include ":${moduleName}"
    project(":${moduleName}").projectDir = AR_LOCAL_PATH

    // if included in other projects, add a hidden file
    // 增加隐藏文件
    def hiddenFile = new File(AR_LOCAL_PATH, INCLUDED_LIB_FILE_NAME)
    if (!hiddenFile.exists()) {
        hiddenFile.createNewFile()
        hiddenFile.withWriter { out ->
            out.println 'This file is auto generated by AndroidRubick'
        }
    }
}




